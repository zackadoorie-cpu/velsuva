<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Vel'Suva — Panel</title><script src="https://cdn.tailwindcss.com"></script><style>:root{--ink:#1f2937;--sand:#f7f3ea;--border:#e5e7eb}@media(prefers-color-scheme:dark){:root{--ink:#e5e7eb;--sand:#0b1020;--border:#24304b}}body{background:var(--sand);color:var(--ink)}</style><script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script><script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script></head><body class="min-h-screen"><div id="root"></div><script type="text/babel">
const {useState} = React;
function QuickButton(props){return React.createElement('button',{className:'px-3 py-1.5 rounded-lg text-sm border bg-white text-slate-900 hover:bg-slate-50 shadow-sm inline-flex items-center gap-2',...props},props.children)}
function App(){
 const [oracle,setOracle]=useState(3); const [founder,setFounder]=useState(4); const [pawn,setPawn]=useState(2); const [rebel,setRebel]=useState(1);
 const [log,setLog]=useState([]); const [gh,setGh]=useState({username:'',repo:'',token:''}); const [busy,setBusy]=useState(false);
 const state={oracle,founder,pawn,rebel,factions:[],sessions:[],hexes:[],history:[]};
 const hookLog=(t)=>setLog(l=>[{t,ts:Date.now()},...l].slice(0,80));
 async function getDefaultBranch(){ const r=await fetch('https://api.github.com/repos/'+gh.username+'/'+gh.repo,{headers:{Authorization:'token '+gh.token,Accept:'application/vnd.github+json'}}); const j=await r.json(); if(!r.ok) throw new Error((j&&j.message)||'repo fetch failed'); return j.default_branch||'main'; }
 async function getBranchSha(b){ const r=await fetch('https://api.github.com/repos/'+gh.username+'/'+gh.repo+'/git/ref/heads/'+encodeURIComponent(b),{headers:{Authorization:'token '+gh.token,Accept:'application/vnd.github+json'}}); const j=await r.json(); if(!r.ok) throw new Error((j&&j.message)||'ref fetch failed'); return j.object&&j.object.sha; }
 async function createBranch(sha,b){ const r=await fetch('https://api.github.com/repos/'+gh.username+'/'+gh.repo+'/git/refs',{method:'POST',headers:{Authorization:'token '+gh.token,Accept:'application/vnd.github+json'},body:JSON.stringify({ref:'refs/heads/'+b,sha})}); const j=await r.json(); if(!r.ok&&j&&j.message&&j.message.includes('Reference already exists')) return true; if(!r.ok) throw new Error((j&&j.message)||'create branch failed'); return true; }
 async function commitFile(path,content,msg,b){ const base='https://api.github.com/repos/'+gh.username+'/'+gh.repo+'/contents/'+encodeURI(path); let sha; const g=await fetch(base+'?ref='+encodeURIComponent(b),{headers:{Authorization:'token '+gh.token,Accept:'application/vnd.github+json'}}); if(g.ok){ const j=await g.json(); sha=j.sha; } const res=await fetch(base,{method:'PUT',headers:{Authorization:'token '+gh.token,Accept:'application/vnd.github+json'},body:JSON.stringify({message:msg,content:btoa(unescape(encodeURIComponent(content))),sha,branch:b})}); const j=await res.json(); if(!res.ok) throw new Error((j&&j.message)||'commit failed'); return j; }
 async function openPR(title,head,base){ const r=await fetch('https://api.github.com/repos/'+gh.username+'/'+gh.repo+'/pulls',{method:'POST',headers:{Authorization:'token '+gh.token,Accept:'application/vnd.github+json'},body:JSON.stringify({title,head,base,body:title})}); const j=await r.json(); if(!r.ok && j && j.errors && j.errors[0] && j.errors[0].message && j.errors[0].message.includes('A pull request already exists')) return j; if(!r.ok) throw new Error((j&&j.message)||'pr failed'); return j; }
 async function savePanel(){ if(!gh.token||!gh.username||!gh.repo){hookLog('set github in settings first'); return;} setBusy(true); try{ const baseB=await getDefaultBranch(); const sha=await getBranchSha(baseB); const branch='velsuva/panel-'+Date.now(); const html=document.documentElement.outerHTML; await commitFile('velsuva/panel.html',html,"Vel'Suva: export panel.html",branch); const pr=await openPR("Vel'Suva: export panel.html",branch,baseB); hookLog('created PR: '+(pr.html_url||'pulls')); window.open(pr.html_url||('https://github.com/'+gh.username+'/'+gh.repo+'/pulls'),'_blank'); }catch(e){ hookLog('panel commit error: '+((e&&e.message)||e)); } finally{ setBusy(false); } }
return (
  <div className='max-w-5xl mx-auto p-4'>
    <h1 className='text-lg font-semibold mb-2'>Vel\'Suva — Panel</h1>
    <div className='grid md:grid-cols-2 gap-4'>
      <div className='p-4 border rounded-2xl bg-white/70'>
        <div className='font-medium mb-2'>Identities</div>
        {[['Oracle',oracle,setOracle],['Founder',founder,setFounder],['Pawn',pawn,setPawn],['Rebel',rebel,setRebel]].map(([label,val,setter]) => (
          <div key={label} className='mb-3'>
            <div className='flex justify-between text-sm mb-1'><span>{label}</span><span>{val}/6</span></div>
            <input type='range' min='0' max='6' value={val} onChange={(e)=>setter(parseInt(e.target.value,10))} className='w-full'/>
          </div>
        ))}
      </div>
      <div className='p-4 border rounded-2xl bg-white/70'>
        <div className='font-medium mb-2'>GitHub</div>
        <input className='border rounded px-2 py-1 mb-2 w-full' placeholder='username' value={gh.username} onChange={(e)=>setGh(v=>({...v,username:e.target.value}))}/>
        <input className='border rounded px-2 py-1 mb-2 w-full' placeholder='repo' value={gh.repo} onChange={(e)=>setGh(v=>({...v,repo:e.target.value}))}/>
        <input className='border rounded px-2 py-1 mb-2 w-full font-mono' placeholder='token (repo scope)' value={gh.token} onChange={(e)=>setGh(v=>({...v,token:e.target.value}))}/>
        <div className='flex flex-wrap gap-2'>
          <QuickButton onClick={savePanel} disabled={busy}>{busy?'Working…':'Commit Panel → Repo'}</QuickButton>
          <QuickButton onClick={()=>{ var u='https://'+gh.username+'.github.io/'+gh.repo+'/velsuva/panel.html'; window.open(u,'_blank'); }}>Open Panel</QuickButton>
        </div>
      </div>
    </div>
    <div className='mt-4 p-4 border rounded-2xl bg-white/70'>
      <div className='font-medium mb-2'>Activity</div>
      <ul className='text-sm space-y-1 max-h-48 overflow-auto'>
        {log.map((e,i)=>(<li key={i}>{new Date(e.ts).toLocaleTimeString()} — {e.t}</li>))}
      </ul>
    </div>
  </div>
);
}
ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
</script></body></html>